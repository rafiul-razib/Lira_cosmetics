<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lira Cosmetics Chatbot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
  <div class="chat-app">
    <!-- Header -->
    <div class="chat-header">
      <div class="bot-avatar">ğŸ’„</div>
      <div>
        <h3>Lira Cosmetics</h3>
        <span class="status">Online</span>
      </div>
    </div>

    <!-- Messages -->
    <div id="chat-box" class="chat-messages"></div>

    <!-- Input -->
  <div class="chat-input">
  <input
    id="user-input"
    class="chat-input-field"
    type="text"
    placeholder="Ask about products, skincare, offers..."
    autocomplete="off"
    onkeydown="if(event.key==='Enter') sendMessage()"
  />
  <div class="flex">
    <button id="micBtn" title="Voice input">ğŸ™ï¸</button>
    <button class="chat-send-btn" onclick="sendMessage()">â¤</button>
  </div>
</div>

  </div>

  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  <script>
  const micBtn = document.getElementById("micBtn");
  const userInput = document.getElementById("user-input");

  // Check browser support
  const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition;

  if (!SpeechRecognition) {
    micBtn.disabled = true;
    micBtn.innerText = "ğŸ¤ Not supported";
  } else {
    const recognition = new SpeechRecognition();
    // recognition.lang = "en-US"; // change to "bn-BD" for Bangla
    recognition.lang = navigator.language || "en-US"; // auto-detect browser language
    recognition.continuous = false;
    recognition.interimResults = false;

    micBtn.onclick = () => {
      recognition.start();
      micBtn.classList.add("pulsing"); // start pulsing
      micBtn.innerText = "ğŸ™...";
    };

    recognition.onresult = (event) => {
      const transcript = event.results[0][0].transcript;
      userInput.value = transcript;
      micBtn.innerText = "ğŸ¤";
      micBtn.classList.remove("pulsing");
      sendMessage(); // auto-send after speaking
    };

    recognition.onerror = () => {
      micBtn.innerText = "ğŸ¤ Speak";
      micBtn.classList.remove("pulsing");
      alert("Voice recognition failed. Try again.");
    };

    recognition.onend = () => {
  micBtn.classList.remove("pulsing");
};
  }
</script>

</body>
</html>
